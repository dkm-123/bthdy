<!DOCTYPE html>
<html>
<body style="margin:0; overflow:hidden">
<canvas id="c"></canvas>

<script>
const c = document.getElementById("c"),
      x = c.getContext("2d");

c.width = innerWidth;
c.height = innerHeight;

let fw = [], p = [], t = Date.now();

// ---------------- FIREWORK ----------------
class Firework {
  constructor() {
    this.x = Math.random() * c.width;
    this.y = c.height;
    this.ty = Math.random() * c.height * 0.4 + 80;
  }
  u() {
    this.y -= 6;
    if (this.y <= this.ty) this.e();
  }
  d() {
    x.fillStyle = "white";
    x.fillRect(this.x, this.y, 2, 2);
  }
  e() {
    for (let i = 0; i < 40; i++) {
      let a = Math.PI * 2 * i / 40,
          s = Math.random() * 3 + 2,
          h = Math.random() * 360;
      p.push({
        x: this.x,
        y: this.y,
        vx: Math.cos(a) * s,
        vy: Math.sin(a) * s,
        a: 1,
        h
      });
    }
    fw.splice(fw.indexOf(this), 1);
  }
}

// ---------------- LOOP ----------------
function loop() {
  x.fillStyle = "rgba(0,0,0,.2)";
  x.fillRect(0, 0, c.width, c.height);

  // fireworks
  fw.forEach(f => {
    f.u();
    f.d();
  });

  p.forEach((o, i) => {
    o.x += o.vx;
    o.y += o.vy;
    o.vy += .02;
    o.a -= .015;

    x.save();
    x.globalAlpha = o.a;
    x.shadowBlur = 15;
    x.shadowColor = `hsl(${o.h},100%,60%)`;
    x.fillStyle = `hsl(${o.h},100%,60%)`;
    x.fillRect(o.x, o.y, 3, 3);
    x.restore();

    if (o.a <= 0) p.splice(i, 1);
  });

  requestAnimationFrame(loop);
}

// ---------------- TIMING ----------------
// Launch fireworks for 7 seconds
let fireworkInterval = setInterval(() => {
  if (Date.now() - t < 7000) {
    fw.push(new Firework());
  } else {
    clearInterval(fireworkInterval);
    // Redirect after fireworks finish
    setTimeout(() => {
      window.location.href = "lamp.html";
    }, 3000); // small delay to let remaining particles fade
  }
}, 700);

loop();
</script>
</body>
</html>
